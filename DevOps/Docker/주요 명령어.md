## 1. **docker ps** vs. **docker ps -a**
```shell
$  docker ps
```
- 현재 실행중인 컨테이너 목록 출력
- 필수 인자 없음
- = `docker container ls`, `docker container ps`

```shell
$ docker ps -a
```
  - 더 이상 실행되지 않는 중지된 컨테이너까지 전부 포함한 목록 출력
<br>


## 2. 이미지 다운로드 후 run
```shell
$ docker pull {이미지명}
```
- image를 pull
- 하지만 run을 따로 해주어야 실행되므로 *바로 run 명령어 사용하는 것을 추천*

```shell
$ docker run {옵션} {이미지명} {명령어} {인자}   
e.g. $ docker run -d -p 1521:1521 oracleinanutshell/oracle-xe-11g /bin/bash -c "tail -f /dev/null"
```
- docker run 커맨드를 사용하면 pull부터 run까지 한번에 수행
<br>


## +) 옵션

### [옵션 특징]
- 컨테이너 실행 방식 정의
- 다양한 동작을 설정할 수 있어 유연한 컨테이너 관리를 지원
- -it, -dit 처럼 여러가지 옵션을 연결하여 커맨드 가능
### [주요 옵션]
1. `-d` (opp. -a)  
    *--detach*   
    - Detached(백그라운드) 모드로 컨테이너를 실행
    - -d 옵션 없이 명령어를 실행한다면 해당 터미널에서 나오는 순간(Ctrl + C) 해당 컨테이너가 종료됨
    ```
    detached 모드?
    - 컨테이너를 백그라운드에서 동작하도록 함
    - 컨테이너 내부에서 포그라운드(bash로 접근 가능)로 실행되어
      컨테이너가 실행되고 나서도 현재 터미널 세션과 상호 작용하지 않음
      (사용자와 입출력이 없는 상태로 컨테이너 실행)
    - detached 모드인 컨테이너는 반드시 컨테이너 내부에서 프로그램이 실행되어야 하며,
      포그라운드 프로그램이 실행되지 않으면 컨테이너 종료
    ```

2. `-p <호스트포트>:<컨테이너포트>`  
    *--publish*
    - 호스트의 포트를 컨테이너의 포트에 매핑
    ```
    ex) docker run -d -p 80:8000 python:3.8-alpine python -m http.server
    ::>> 컨테이너 내부에서 8000번 포트로 리스닝하고 있는 HTTP 서버를   
        호스트 컴퓨터에서 80번 포트로 접속할 수 있도록 함
    ```

3. `--name <설정할 컨테이너명> ... <이미지명>`  
    - 컨테이너에 이름을 지정
    ```
    ex) docker run --name oracle11g -dit -p 1521:1521 oracleinanutshell/oracle-xe-11g
    ::>> image를 pull할때 이미지명을 사용자 정의 이름으로 변경하여 저장
    ```

4. `-e <환경변수>=<값>`  
    *--env*
    - 컨테이너 내부에서 사용할 환경 변수를 설정

5. `-v <호스트경로>:<컨테이너경로>`  
    *--volume*
    - 호스트의 디렉토리를 컨테이너의 디렉토리에 마운트
    - 데이터를 공유하거나 저장하는 등 데이터 지속성을 위해 사용

6. `--rm`   
    - 컨테이너가 종료될 때 자동으로 삭제되도록 함

7. `--network <네트워크명>`   
    - 컨테이너가 연결될 네트워크를 지정

8. `-it` ('-i' + '-t')
    - 컨테이너 내부로 진입하도록 attach 가능한 상태로 설정
    - 이 두 옵션은 같이 쓰이는 경우가 매우 많음
    - 컨테이너를 종료하지 않은 채로, 터미널의 입력을 계속해서 컨테이너로 전달
    - 컨테이너의 쉘(shell)이나 CLI 도구를 사용할 때 매우 유용하게 사용
<br>


## 3. **docker start {컨테이너명}** & **docker stop {컨테이너명}**
- 해당 컨테이너를 실행 or 정지
- 변경사항이 없어 다시 이미지부터 빌드할 필요가 없을 때 ps -a 목록에서 컨테이너명 찾아서 start

  - start로 시작하는 경우 Detached 모드가 디폴트 (터미널 차단 X)   
  run으로 시작하는 경우 Attached 모드가 디폴트 (터미널 차단 O)
  - '-d', '-a' 옵션을 사용하여 모드 변경 가능
<br>

      
## 4. **docker exec** vs. **docker attach**
컨테이너 접속 명령어이며, 컨테이너가 실행되고 있을 때만 사용 가능 (docker ps 목록에 존재)

```shell
$ docker exec {컨테이너ID} {옵션}
e.g. $ docker exec -it oracle11g /bin/bash
```
- 컨테이너 외부에서 실행 중인 컨테이너에 명령어를 전달하여 내부에서 실행 (외부 접근 -> 내부 전달)
- 컨테이너 내부에서 실행하는 것처럼 결과를 출력
- cd 명령어는 실행하지 못함
- 주로 디버깅 용도로 사용
- /bin/bash를 실행하지 않아도 bash 셸에 접근 가능
- 컨테이너를 재시작(exit 또는 Ctrl+D 입력)해도 종료되지 않음 (/bin/bash만 중지)

```shell
$ docker attach {컨테이너ID or 컨테이너명}
```
- 실행 중인 컨테이너에 직접 들어가 명령어 실행 (내부 접근)
- Apache나 MySQL 등 작동 중인 프로그램에 attach 시 주의 필요 (비정상 종료 가능성)
- 셀에서 빠져나올 땐 Ctrl + pq
- attach는 exec와 달리 처음 컨테이너를 run할 때 /bin/bash를 지정하지 않으면 bash 셸에 접근 불가
<br>


## +) Docker 네트워크 구성 방식

  ### [가상 네트워크 종류]
  **1) Host-Only**
  - 구성된 가상머신들끼리만 통신 가능 (외부와 단절)
  - 테스트 환경을 구축할 때 유용

  **2) NAT(Network Address Translation)**
  - 호스트 pc로부터 IP를 할당받고 IP 할당받은 가상머신은 자체 DHCP 서버를 띄워 내부 네트워크 대역을 할당받음
  - *호스트 PC를 통해 외부 네트워크와 통신*

  **3) Bridge**
  - 공유기로부터 IP를 할당받아 호스트 PC와 동일한 IP 대역 사용
  - *공유기를 통해 외부 네트워크와 통신*
  - 가상 머신이 외부 네트워크와 직접 통신할 수 있도록 함
  
  ### [Docker 네트워크 구성 방식]
  **1) Bridge**
  - 별도의 설정이 없을 때 생성되는 default 모드
  - Bridge 네트워크에 연결된 컨테이너들은 같은 네트워크 대역에 존재하므로 서로 통신 가능
  
  **2) Host**
  - 호스트의 네트워크 스택을 사용하여 컨테이너와 호스트가 동일한 IP 주소 공유
  - 컨테이너와 호스트가 직접 통신 가능

  **3) none**
  - 네트워크가 없는 모드
  - 컨테이너가 네트워크에 연결되지 않도록 설정하여 특정한 용도로 사용됨
